weather$events <- as.factor(weather$events)
levels(weather$events)
weather$events<- as.character(weather$events)
weather$events[is.na(weather$events)] <- "Clear Skies"
weather$events
library(tidyverse)
library(naniar)
library(skimr)
weather <- readr::read_csv("data/weather.csv")
weather
weather %>%
select(-"X1")
glimpse(weather)
colnames(weather)
new_factor<- c(1:5,26)
new_numeric<- c(6:25)
weather[,new_factor] <- lapply(weather[,new_factor], as.factor)
weather[,new_numeric] <- lapply(weather[,new_numeric], as.numeric)
lapply(weather, class) #changing classes
weather %>%
filter(year=="2017") %>%
select(city, avg_temp) %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp))
weather %>%
filter(year=="2017") %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp)) %>%
ggplot(aes(x=city, yearly_avg_temp)) +
geom_bar(stat = "identity")
weather$events<- as.character(weather$events)
weather$events[is.na(weather$events)] <- "Clear Skies"
weather$events
weather$events<- as.character(weather$events)
skies < - weather$events[is.na(weather$events)] <- "Clear Skies"
weather$events<- as.character(weather$events)
skies <- weather$events[is.na(weather$events)] <- "Clear Skies"
skies$events
weather$events <- as.factor(weather$events)
levels(weather$events)
weather_events <- weather %>%
select(city, events)
skies <- weather %>%
select(city, events)
skies$events[skies$events!="Clear Skies"] <- "Rain"
skies$events
library(tidyverse)
library(naniar)
library(skimr)
weather <- readr::read_csv("data/weather.csv")
weather
weather %>%
select(-"X1")
glimpse(weather)
colnames(weather)
new_factor<- c(1:5,26)
new_numeric<- c(6:25)
weather[,new_factor] <- lapply(weather[,new_factor], as.factor)
weather[,new_numeric] <- lapply(weather[,new_numeric], as.numeric)
lapply(weather, class) #changing classes
weather %>%
filter(year=="2017") %>%
select(city, avg_temp) %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp))
weather %>%
filter(year=="2017") %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp)) %>%
ggplot(aes(x=city, yearly_avg_temp)) +
geom_bar(stat = "identity")
weather$events<- as.character(weather$events)
weather$events[is.na(weather$events)] <- "Clear Skies"
weather$events
skies <- weather %>%
select(city, events)
skies %>%
filter(City==city== "Auckland", Events==events) %>%
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=Events)) +
geom_bar()
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar()
skies %>%
filter(city== "Auckland", Events==events) %>%
ggplot(aes(x=Events)) +
geom_bar()
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar()
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "yellow", color="black", alpha =.5)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "blue", color="black", alpha =.5)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weathe Events",
y= "Count")
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count")
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = rel(1), hjust = 0.5))
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = rel(2), hjust = 0.5))
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 27, face = "bold", hjust = 0.5),
axis.text = element_text(size = 15),
axis.title = element_text(size = 18),)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "brown1", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)
skies %>%
filter(city== "Beijing") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "darkgoldenrod2", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "brown1", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Beijing") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "darkgoldenrod2", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Chicago") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "palegreen1", color="black", alpha =.5) +
labs(title = "Weather Events in Chicago",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Mumbai") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "San Diego") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "magenta", color="black", alpha =.5) +
labs(title = "Weather Events in San Diego",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "San Diego") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "magenta", color="black", alpha =.5) +
labs(title = "Weather Events in San Diego",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
library(tidyverse)
library(naniar)
library(skimr)
weather <- readr::read_csv("data/weather.csv")
weather
weather %>%
select(-"X1")
glimpse(weather)
colnames(weather)
new_factor<- c(1:5,26)
new_numeric<- c(6:25)
weather[,new_factor] <- lapply(weather[,new_factor], as.factor)
weather[,new_numeric] <- lapply(weather[,new_numeric], as.numeric)
lapply(weather, class) #changing classes
weather %>%
filter(year=="2017") %>%
select(city, avg_temp) %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp))
weather %>%
filter(year=="2017") %>%
group_by(city) %>%
summarize(yearly_avg_temp=mean(avg_temp)) %>%
ggplot(aes(x=city, yearly_avg_temp)) +
geom_bar(stat = "identity")
weather$events<- as.character(weather$events)
weather$events[is.na(weather$events)] <- "Clear Skies"
skies <- weather %>%
select(city, events)
skies %>%
filter(city== "Auckland") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "brown1", color="black", alpha =.5) +
labs(title = "Weather Events in Auckland",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Beijing") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "darkgoldenrod2", color="black", alpha =.5) +
labs(title = "Weather Events in Beijing",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Chicago") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "palegreen1", color="black", alpha =.5) +
labs(title = "Weather Events in Chicago",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Mumbai") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "deepskyblue", color="black", alpha =.5) +
labs(title = "Weather Events in Mumbai",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Chicago") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "gainsboro", color="black", alpha =.5) +
labs(title = "Weather Events in Chicago",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Chicago") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "forestgreen", color="black", alpha =.5) +
labs(title = "Weather Events in Chicago",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Chicago") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "palegreen1", color="black", alpha =.5) +
labs(title = "Weather Events in Chicago",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies %>%
filter(city== "San Diego") %>%
ggplot(aes(x=events)) +
geom_bar(fill = "magenta", color="black", alpha =.5) +
labs(title = "Weather Events in San D",
x= "Weather Events",
y= "Count") +
theme(plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 15),)+
coord_flip()
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies$events <-as.factor(skies$events)
skies$events
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies$events <-as.factor(skies$events)
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies$events <-as.character(skies$events)
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies$events <-as.numeric(skies$events)
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarise(Count=count(events))
skies %>%
filter(city== "Auckland") %>%
count(events)
skies %>%
filter(city== "Auckland") %>%
group_by(events)
skies$events <-as.factor(skies$events)
skies %>%
filter(city== "Auckland") %>%
group_by(events)
skies %>%
filter(city== "Auckland") %>%
group_by(events)
skies %>%
filter(city== "Auckland") %>%
group_by(events) %>%
summarize(count(events))
weather %>%
mutate_at(vars(month), as.factor) %>%
filter(year== 2016) %>%
group_by(month, city) %>%
summarize(mean_avgtemp=mean(avg_temp))  %>%
ggplot(aes(x=month, y=mean_avgtemp, color=city, group=city))+
geom_line() +
geom_point(alpha=0.8)+
labs(title="2016 Monthly Average Temperature",
x= "Month",
y="Average Temperature (Fº)") +
theme(plot.title = element_text(size = 18, face = "bold"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12))
weather %>%
mutate_at(vars(month), as.factor) %>%
filter(year== 2016) %>%
group_by(month, city) %>%
summarize(mean_avgtemp=mean(avg_temp))  %>%
ggplot(aes(x=month, y=mean_avgtemp, color=city, group=city))+
geom_line() +
geom_point(alpha=0.8)+
labs(title="2016 Monthly Average Temperature",
x= "Month",
y="Average Temperature (Fº)") +
theme(plot.title = element_text(size = 18, face = "bold"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12))
library("xml2")
library("glue")
library("skimr")
library("tidyverse")
library("naniar")
library("shiny")
library("shinydashboard")
weather <- readr::read_csv("data/Weather.csv")
new_factor<- c(1:5,26)
new_numeric<- c(6:25)
weather[,new_factor] <- lapply(weather[,new_factor], as.factor)
weather[,new_numeric] <- lapply(weather[,new_numeric], as.numeric)
lapply(weather, class) #changing classes
weather_temp <- weather %>%
select(year, city, avg_temp) %>%
group_by(city, year) %>%
summarize(Average_Temp=mean(avg_temp)) %>%
rename(City="city", Year="year")
weather_dewpt <-weather %>%
select(year, city, avg_dewpt) %>%
group_by(city, year) %>%
summarize(Average_Dew_Point=mean(avg_dewpt)) %>%
select(-c("year"))
weather_humidty <- weather %>%
select(year, city, avg_humidity) %>%
group_by(city, year) %>%
summarize(Average_Humidty=mean(avg_humidity)) %>%
select(-c("year"))
weather_wind <- weather %>%
select(year, city, avg_wind) %>%
group_by(city, year) %>%
summarize(Average_Wind=mean(avg_wind)) %>%
select(-c("year"))
weather_mean <- cbind(weather_temp, weather_dewpt, weather_humidty, weather_wind) #combining yearly average into one table
weather_cleaner <- weather_mean %>%
select(-c(4,6,8)) %>%
pivot_longer(Average_Temp:Average_Wind,
names_to = "Measure",
values_to = "Value")
weather_cleaner
weather %>%
mutate_at(vars(month), as.factor) %>%
filter(year== 2016) %>%
group_by(month, city) %>%
summarize(mean_avgtemp=mean(avg_temp))  %>%
ggplot(aes(x=month, y=mean_avgtemp, color=city, group=city))+
geom_line() +
geom_point(alpha=0.8)+
labs(title="2016 Monthly Average Temperature",
x= "Month",
y="Average Temperature (Fº)") +
theme(plot.title = element_text(size = 18, face = "bold"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12))
png("month_all_16.png")
plot
dev.off()
